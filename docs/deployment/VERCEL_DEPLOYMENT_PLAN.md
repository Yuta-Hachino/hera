# Vercel ãƒ‡ãƒ—ãƒ­ã‚¤è¨ˆç”»

**ä½œæˆæ—¥**: 2025-10-28
**ç›®çš„**: Vercelã‚’ä½¿ã£ãŸæœ€é©ãªãƒ‡ãƒ—ãƒ­ã‚¤æ§‹æˆ

---

## ğŸ“‹ ç›®æ¬¡

1. [Vercelæ¡ç”¨ã®ãƒ¡ãƒªãƒƒãƒˆ](#1-vercelæ¡ç”¨ã®ãƒ¡ãƒªãƒƒãƒˆ)
2. [ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ](#2-ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ)
3. [å®Ÿè£…æ§‹æˆ](#3-å®Ÿè£…æ§‹æˆ)
4. [ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †](#4-ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †)
5. [ã‚³ã‚¹ãƒˆæ¯”è¼ƒ](#5-ã‚³ã‚¹ãƒˆæ¯”è¼ƒ)
6. [ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–](#6-ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–)
7. [å®Ÿè£…ã‚¿ã‚¹ã‚¯](#7-å®Ÿè£…ã‚¿ã‚¹ã‚¯)

---

## 1. Vercelæ¡ç”¨ã®ãƒ¡ãƒªãƒƒãƒˆ

### ğŸ¯ ä¸»è¦ãªãƒ¡ãƒªãƒƒãƒˆ

| é …ç›® | AWS ECSæ¡ˆ | **Vercelæ¡ˆ** | æ”¹å–„ |
|------|-----------|-------------|------|
| **æœˆé¡ã‚³ã‚¹ãƒˆ** | $50 | **$0 - $20** | **-$30 - $50** |
| **ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚é–“** | 3åˆ† | **30ç§’** | **-83%** |
| **ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—** | 8æ™‚é–“ | **30åˆ†** | **-94%** |
| **ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°** | æ‰‹å‹•è¨­å®š | **è‡ªå‹•ï¼ˆç„¡é™ï¼‰** | âœ… |
| **CDN** | åˆ¥é€”è¨­å®š | **æ¨™æº–æ­è¼‰** | âœ… |
| **HTTPS** | ACMè¨­å®šå¿…è¦ | **è‡ªå‹•** | âœ… |
| **Gité€£æº** | GitHub Actions | **è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤** | âœ… |
| **ã‚¼ãƒ­ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ** | è¦è¨­å®š | **æ¨™æº–** | âœ… |

---

### âœ… Vercelç‰¹æœ‰ã®åˆ©ç‚¹

1. **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ + ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’1ç®‡æ‰€ã«**
   - Next.jsï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰
   - API Routes / Serverless Functionsï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼‰
   - çµ±åˆç®¡ç†

2. **ã‚°ãƒ­ãƒ¼ãƒãƒ«CDN**
   - ä¸–ç•Œä¸­ã«é…ä¿¡
   - è‡ªå‹•æœ€é©åŒ–
   - ç”»åƒæœ€é©åŒ–ã‚‚æ¨™æº–è£…å‚™

3. **ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ‡ãƒ—ãƒ­ã‚¤**
   - Pull Requestã”ã¨ã«è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤
   - ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒç°¡å˜

4. **ç„¡æ–™æ ãŒå¤§ãã„**
   - Hobby: å®Œå…¨ç„¡æ–™ï¼ˆå€‹äººãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼‰
   - Pro: $20/æœˆï¼ˆå•†ç”¨ï¼‰

5. **ç’°å¢ƒå¤‰æ•°ç®¡ç†**
   - ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ç°¡å˜è¨­å®š
   - ç’°å¢ƒåˆ¥ï¼ˆdev/preview/prodï¼‰

---

## 2. ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ

### 2.1 æœ€çµ‚ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼ˆVercelç‰ˆï¼‰

```mermaid
graph TB
    subgraph "ãƒ¦ãƒ¼ã‚¶ãƒ¼"
        User[ãƒ¦ãƒ¼ã‚¶ãƒ¼<br/>ä¸–ç•Œä¸­]
    end

    subgraph "Vercel Edge Networkï¼ˆCDNï¼‰"
        Edge[Edge Network<br/>ä¸–ç•Œ100+ç®‡æ‰€]
    end

    subgraph "Vercel Deployment"
        subgraph "Frontend"
            NextJS[Next.js<br/>SSR + SSG]
            Pages[Pages<br/>ãƒ­ã‚°ã‚¤ãƒ³ã€ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã€ãƒãƒ£ãƒƒãƒˆ]
        end

        subgraph "Backend"
            APIRoutes[API Routes<br/>Serverless Functions]
            Auth[èªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢<br/>JWTæ¤œè¨¼]
        end

        subgraph "External Functions"
            ADK[Vercel Function<br/>Google ADKå‡¦ç†]
        end
    end

    subgraph "Supabase"
        SupaAuth[Supabase Auth<br/>Google OAuth]
        DB[(PostgreSQL<br/>+ RLS)]
        Storage[(Storage<br/>ç”»åƒ)]
        Realtime[Realtime<br/>WebSocket]
    end

    subgraph "External APIs"
        Gemini[Gemini API<br/>Google AI]
    end

    User -->|HTTPS| Edge
    Edge -->|æœ€å¯„ã‚Šã®ã‚¨ãƒƒã‚¸| NextJS

    NextJS -->|èªè¨¼| SupaAuth
    NextJS -->|APIå‘¼ã³å‡ºã—| APIRoutes

    APIRoutes -->|JWTæ¤œè¨¼| Auth
    Auth -->|ãƒ‡ãƒ¼ã‚¿å–å¾—| DB
    APIRoutes -->|ç”»åƒä¿å­˜| Storage
    APIRoutes -->|Agentå‡¦ç†| ADK

    ADK -->|AIå‡¦ç†| Gemini
    ADK -->|çµæœä¿å­˜| DB

    DB -.->|å¤‰æ›´é€šçŸ¥| Realtime
    Realtime -.->|WebSocket| NextJS

    style Edge fill:#000000,color:#ffffff
    style NextJS fill:#000000,color:#ffffff
    style APIRoutes fill:#000000,color:#ffffff
    style SupaAuth fill:#3ecf8e
    style DB fill:#3ecf8e
    style Storage fill:#3ecf8e
```

---

### 2.2 ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
hera/
â”œâ”€â”€ app/                          # Next.js App Router
â”‚   â”œâ”€â”€ (auth)/
â”‚   â”‚   â”œâ”€â”€ login/
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx         # ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢
â”‚   â”‚   â””â”€â”€ layout.tsx           # èªè¨¼ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
â”‚   â”‚
â”‚   â”œâ”€â”€ (dashboard)/
â”‚   â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx         # ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
â”‚   â”‚   â”œâ”€â”€ chat/
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx         # ãƒãƒ£ãƒƒãƒˆç”»é¢
â”‚   â”‚   â””â”€â”€ layout.tsx           # ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
â”‚   â”‚
â”‚   â”œâ”€â”€ api/                     # â˜… API Routesï¼ˆServerless Functionsï¼‰
â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”‚   â””â”€â”€ [...supabase]/
â”‚   â”‚   â”‚       â””â”€â”€ route.ts     # Supabase Auth callback
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ sessions/
â”‚   â”‚   â”‚   â”œâ”€â”€ route.ts         # POST /api/sessionsï¼ˆä½œæˆï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚   â”‚       â”œâ”€â”€ route.ts     # GET /api/sessions/[id]
â”‚   â”‚   â”‚       â””â”€â”€ messages/
â”‚   â”‚   â”‚           â””â”€â”€ route.ts # POST /api/sessions/[id]/messages
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ agent/
â”‚   â”‚   â”‚   â””â”€â”€ route.ts         # POST /api/agentï¼ˆADKå‡¦ç†ï¼‰
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ upload/
â”‚   â”‚       â””â”€â”€ route.ts         # POST /api/uploadï¼ˆç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ layout.tsx               # ãƒ«ãƒ¼ãƒˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
â”‚   â””â”€â”€ page.tsx                 # ãƒ›ãƒ¼ãƒ 
â”‚
â”œâ”€â”€ components/                  # React ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”œâ”€â”€ LoginButton.tsx
â”‚   â”‚   â”œâ”€â”€ LogoutButton.tsx
â”‚   â”‚   â””â”€â”€ AuthProvider.tsx
â”‚   â”œâ”€â”€ chat/
â”‚   â”‚   â”œâ”€â”€ ChatInterface.tsx
â”‚   â”‚   â”œâ”€â”€ MessageList.tsx
â”‚   â”‚   â””â”€â”€ MessageInput.tsx
â”‚   â””â”€â”€ layout/
â”‚       â””â”€â”€ Header.tsx
â”‚
â”œâ”€â”€ lib/                         # ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
â”‚   â”œâ”€â”€ supabase/
â”‚   â”‚   â”œâ”€â”€ client.ts           # ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´Supabase
â”‚   â”‚   â”œâ”€â”€ server.ts           # ã‚µãƒ¼ãƒãƒ¼å´Supabase
â”‚   â”‚   â””â”€â”€ middleware.ts       # ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢
â”‚   â”œâ”€â”€ agent/
â”‚   â”‚   â””â”€â”€ gemini.ts           # Gemini API ãƒ©ãƒƒãƒ‘ãƒ¼
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ helpers.ts
â”‚
â”œâ”€â”€ middleware.ts                # Next.js Middlewareï¼ˆèªè¨¼ãƒã‚§ãƒƒã‚¯ï¼‰
â”œâ”€â”€ next.config.js
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ vercel.json                  # Vercelè¨­å®š
```

---

## 3. å®Ÿè£…æ§‹æˆ

### 3.1 Next.js API Routesï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼‰

**app/api/sessions/route.ts**

```typescript
import { NextRequest, NextResponse } from 'next/server'
import { createClient } from '@/lib/supabase/server'
import { v4 as uuidv4 } from 'uuid'

// POST /api/sessions - ã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆ
export async function POST(request: NextRequest) {
  try {
    const supabase = createClient()

    // èªè¨¼ãƒã‚§ãƒƒã‚¯
    const { data: { user }, error: authError } = await supabase.auth.getUser()
    if (authError || !user) {
      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })
    }

    // ã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆ
    const sessionId = uuidv4()
    const { data, error } = await supabase
      .from('sessions')
      .insert({
        session_id: sessionId,
        user_id: user.id,
        status: 'active',
      })
      .select()
      .single()

    if (error) throw error

    return NextResponse.json({
      session_id: sessionId,
      created_at: data.created_at,
    })
  } catch (error) {
    console.error('Error creating session:', error)
    return NextResponse.json(
      { error: 'Internal server error' },
      { status: 500 }
    )
  }
}

// GET /api/sessions - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸€è¦§
export async function GET(request: NextRequest) {
  try {
    const supabase = createClient()

    const { data: { user }, error: authError } = await supabase.auth.getUser()
    if (authError || !user) {
      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })
    }

    // RLSãŒè‡ªå‹•çš„ã«user_idã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
    const { data, error } = await supabase
      .from('sessions')
      .select('*')
      .order('created_at', { ascending: false })

    if (error) throw error

    return NextResponse.json({ sessions: data })
  } catch (error) {
    console.error('Error fetching sessions:', error)
    return NextResponse.json(
      { error: 'Internal server error' },
      { status: 500 }
    )
  }
}
```

---

**app/api/sessions/[id]/messages/route.ts**

```typescript
import { NextRequest, NextResponse } from 'next/server'
import { createClient } from '@/lib/supabase/server'
import { generateAIResponse } from '@/lib/agent/gemini'

export async function POST(
  request: NextRequest,
  { params }: { params: { id: string } }
) {
  try {
    const supabase = createClient()
    const sessionId = params.id

    // èªè¨¼ãƒã‚§ãƒƒã‚¯
    const { data: { user }, error: authError } = await supabase.auth.getUser()
    if (authError || !user) {
      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })
    }

    // ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚‚ã®ã‹ç¢ºèª
    const { data: session, error: sessionError } = await supabase
      .from('sessions')
      .select('*')
      .eq('session_id', sessionId)
      .single()

    if (sessionError || !session || session.user_id !== user.id) {
      return NextResponse.json({ error: 'Forbidden' }, { status: 403 })
    }

    // ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£
    const { message } = await request.json()

    // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¿å­˜
    await supabase.from('conversation_history').insert({
      session_id: sessionId,
      speaker: 'user',
      message,
    })

    // AIå¿œç­”ç”Ÿæˆï¼ˆGemini APIï¼‰
    const aiResponse = await generateAIResponse(sessionId, message, supabase)

    // AIå¿œç­”ã‚’ä¿å­˜
    await supabase.from('conversation_history').insert({
      session_id: sessionId,
      speaker: 'agent',
      message: aiResponse.message,
      extracted_fields: aiResponse.extracted_fields,
    })

    return NextResponse.json({
      message: aiResponse.message,
      extracted_fields: aiResponse.extracted_fields,
    })
  } catch (error) {
    console.error('Error sending message:', error)
    return NextResponse.json(
      { error: 'Internal server error' },
      { status: 500 }
    )
  }
}
```

---

### 3.2 Supabase ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆã‚µãƒ¼ãƒãƒ¼å´ï¼‰

**lib/supabase/server.ts**

```typescript
import { createServerClient, type CookieOptions } from '@supabase/ssr'
import { cookies } from 'next/headers'

export function createClient() {
  const cookieStore = cookies()

  return createServerClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
    {
      cookies: {
        get(name: string) {
          return cookieStore.get(name)?.value
        },
        set(name: string, value: string, options: CookieOptions) {
          try {
            cookieStore.set({ name, value, ...options })
          } catch (error) {
            // Server Componentã‹ã‚‰set()ã¯å‘¼ã¹ãªã„å ´åˆãŒã‚ã‚‹
          }
        },
        remove(name: string, options: CookieOptions) {
          try {
            cookieStore.set({ name, value: '', ...options })
          } catch (error) {
            // Server Componentã‹ã‚‰remove()ã¯å‘¼ã¹ãªã„å ´åˆãŒã‚ã‚‹
          }
        },
      },
    }
  )
}
```

---

### 3.3 èªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢

**middleware.ts**

```typescript
import { createServerClient, type CookieOptions } from '@supabase/ssr'
import { NextResponse, type NextRequest } from 'next/server'

export async function middleware(request: NextRequest) {
  let response = NextResponse.next({
    request: {
      headers: request.headers,
    },
  })

  const supabase = createServerClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
    {
      cookies: {
        get(name: string) {
          return request.cookies.get(name)?.value
        },
        set(name: string, value: string, options: CookieOptions) {
          request.cookies.set({
            name,
            value,
            ...options,
          })
          response = NextResponse.next({
            request: {
              headers: request.headers,
            },
          })
          response.cookies.set({
            name,
            value,
            ...options,
          })
        },
        remove(name: string, options: CookieOptions) {
          request.cookies.set({
            name,
            value: '',
            ...options,
          })
          response = NextResponse.next({
            request: {
              headers: request.headers,
            },
          })
          response.cookies.set({
            name,
            value: '',
            ...options,
          })
        },
      },
    }
  )

  // ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼çŠ¶æ…‹ã‚’ç¢ºèª
  const {
    data: { user },
  } = await supabase.auth.getUser()

  // èªè¨¼ãŒå¿…è¦ãªãƒšãƒ¼ã‚¸
  if (!user && request.nextUrl.pathname.startsWith('/dashboard')) {
    return NextResponse.redirect(new URL('/login', request.url))
  }

  // æ—¢ã«ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ã®å ´åˆã¯ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã«ã‚¢ã‚¯ã‚»ã‚¹ã•ã›ãªã„
  if (user && request.nextUrl.pathname === '/login') {
    return NextResponse.redirect(new URL('/dashboard', request.url))
  }

  return response
}

export const config = {
  matcher: [
    '/((?!_next/static|_next/image|favicon.ico|.*\\.(?:svg|png|jpg|jpeg|gif|webp)$).*)',
  ],
}
```

---

## 4. ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †

### 4.1 Vercelãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ

#### Step 1: GitHubãƒªãƒã‚¸ãƒˆãƒªæº–å‚™

```bash
# æ—¢å­˜ã®Heraãƒªãƒã‚¸ãƒˆãƒªã‚’ä½¿ç”¨
cd hera
git checkout main
```

#### Step 2: Vercel CLI ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
npm install -g vercel
```

#### Step 3: Vercelã«ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
# ãƒ­ã‚°ã‚¤ãƒ³
vercel login

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–
vercel

# ä»¥ä¸‹ã®è³ªå•ã«ç­”ãˆã‚‹:
? Set up and deploy "hera"? [Y/n] y
? Which scope do you want to deploy to? <your-username>
? Link to existing project? [y/N] n
? What's your project's name? hera
? In which directory is your code located? ./
? Want to override the settings? [y/N] n
```

---

### 4.2 ç’°å¢ƒå¤‰æ•°è¨­å®š

**Vercel Dashboard ã§è¨­å®š**:

```bash
# Supabase
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key

# Gemini API
GEMINI_API_KEY=your-gemini-api-key

# ãã®ä»–
NODE_ENV=production
```

**ã¾ãŸã¯ã€CLIã§è¨­å®š**:

```bash
vercel env add NEXT_PUBLIC_SUPABASE_URL
vercel env add NEXT_PUBLIC_SUPABASE_ANON_KEY
vercel env add SUPABASE_SERVICE_ROLE_KEY
vercel env add GEMINI_API_KEY
```

---

### 4.3 vercel.json è¨­å®š

**vercel.json**

```json
{
  "buildCommand": "npm run build",
  "devCommand": "npm run dev",
  "installCommand": "npm install",
  "framework": "nextjs",
  "regions": ["iad1", "sfo1", "hnd1"],
  "functions": {
    "app/api/**/*.ts": {
      "maxDuration": 30,
      "memory": 1024
    }
  },
  "headers": [
    {
      "source": "/api/(.*)",
      "headers": [
        {
          "key": "Access-Control-Allow-Origin",
          "value": "*"
        },
        {
          "key": "Access-Control-Allow-Methods",
          "value": "GET, POST, PUT, DELETE, OPTIONS"
        },
        {
          "key": "Access-Control-Allow-Headers",
          "value": "Content-Type, Authorization"
        }
      ]
    }
  ]
}
```

---

### 4.4 è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤è¨­å®š

**Gité€£æºã§è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤**:

```bash
# mainãƒ–ãƒ©ãƒ³ãƒã¸ã®pushã§è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤
git push origin main

# Pull Requestã§ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ‡ãƒ—ãƒ­ã‚¤
git checkout -b feature/new-feature
git push origin feature/new-feature
# â†’ VercelãŒè‡ªå‹•ã§ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼URLç”Ÿæˆ
```

---

## 5. ã‚³ã‚¹ãƒˆæ¯”è¼ƒ

### 5.1 æœˆé¡ã‚³ã‚¹ãƒˆï¼ˆè©³ç´°ï¼‰

#### ğŸ”´ AWS ECSæ¡ˆï¼ˆæ—§æ¡ˆï¼‰

| ã‚µãƒ¼ãƒ“ã‚¹ | æœˆé¡ |
|---------|------|
| ECS Fargateï¼ˆ0.25 vCPUã€512MBï¼‰ | $10 |
| ECS Fargateï¼ˆ0.5 vCPUã€1GBï¼‰- ADK | $20 |
| ALBï¼ˆApplication Load Balancerï¼‰ | $20 |
| VPCã€NAT Gateway | $30 |
| CloudWatch Logs | $5 |
| **åˆè¨ˆ** | **$85/æœˆ** |

#### ğŸŸ¢ Vercelæ¡ˆï¼ˆæ–°æ¡ˆï¼‰

| ãƒ—ãƒ©ãƒ³ | æœˆé¡ | å†…å®¹ |
|--------|------|------|
| **Hobbyï¼ˆå€‹äººï¼‰** | **$0** | ç„¡åˆ¶é™ãƒ‡ãƒ—ãƒ­ã‚¤ã€100GBå¸¯åŸŸã€Serverless Functions |
| **Proï¼ˆå•†ç”¨ï¼‰** | **$20** | ãƒãƒ¼ãƒ æ©Ÿèƒ½ã€å„ªå…ˆã‚µãƒãƒ¼ãƒˆã€åˆ†æ |

---

### 5.2 ç·ã‚³ã‚¹ãƒˆæ¯”è¼ƒ

| æ§‹æˆ | ã‚¤ãƒ³ãƒ•ãƒ© | é‹ç”¨å·¥æ•° | åˆè¨ˆ/æœˆ | åˆè¨ˆ/å¹´ |
|------|---------|----------|---------|---------|
| **AWS ECS + Supabase** | $85 + $25 = $110 | $100 | **$210** | **$2,520** |
| **Vercel Hobby + Supabase** | $0 + $25 = $25 | $50 | **$75** | **$900** |
| **Vercel Pro + Supabase** | $20 + $25 = $45 | $50 | **$95** | **$1,140** |

**å¹´é–“å‰Šæ¸›é¡ï¼ˆvs AWS ECSï¼‰**:
- Hobby: **$1,620å‰Šæ¸›**ï¼ˆ64%å‰Šæ¸›ï¼‰
- Pro: **$1,380å‰Šæ¸›**ï¼ˆ55%å‰Šæ¸›ï¼‰

---

### 5.3 ä½¿ç”¨é‡ã«ã‚ˆã‚‹è¿½åŠ ã‚³ã‚¹ãƒˆ

#### Vercel Hobbyï¼ˆç„¡æ–™ï¼‰ã®åˆ¶é™

| é …ç›® | åˆ¶é™ |
|------|------|
| å¸¯åŸŸå¹… | 100GB/æœˆ |
| Functionå®Ÿè¡Œæ™‚é–“ | 100æ™‚é–“/æœˆ |
| ãƒ“ãƒ«ãƒ‰æ™‚é–“ | 100æ™‚é–“/æœˆ |
| ç”»åƒæœ€é©åŒ– | 1,000æš/æœˆ |

**è¶…éã—ãŸå ´åˆ**: è‡ªå‹•çš„ã«Proãƒ—ãƒ©ãƒ³ã¸ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ãŒå¿…è¦

#### Vercel Proï¼ˆ$20/æœˆï¼‰

| é …ç›® | åˆ¶é™ |
|------|------|
| å¸¯åŸŸå¹… | 1TB/æœˆ |
| Functionå®Ÿè¡Œæ™‚é–“ | 1,000æ™‚é–“/æœˆ |
| ãƒ“ãƒ«ãƒ‰æ™‚é–“ | 400æ™‚é–“/æœˆ |
| ç”»åƒæœ€é©åŒ– | 5,000æš/æœˆ |

**è¶…éèª²é‡‘**: å¸¯åŸŸå¹… $40/TBã€Function $40/100æ™‚é–“

---

## 6. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### 6.1 Next.jsæœ€é©åŒ–

**next.config.js**

```javascript
/** @type {import('next').NextConfig} */
const nextConfig = {
  // ç”»åƒæœ€é©åŒ–
  images: {
    domains: ['your-project.supabase.co'],
    formats: ['image/avif', 'image/webp'],
  },

  // Vercel Analytics
  experimental: {
    instrumentationHook: true,
  },

  // ãƒ“ãƒ«ãƒ‰æœ€é©åŒ–
  swcMinify: true,
  compress: true,

  // ã‚­ãƒ£ãƒƒã‚·ãƒ¥è¨­å®š
  headers: async () => [
    {
      source: '/api/:path*',
      headers: [
        {
          key: 'Cache-Control',
          value: 'public, s-maxage=10, stale-while-revalidate=59',
        },
      ],
    },
  ],
}

module.exports = nextConfig
```

---

### 6.2 ã‚¨ãƒƒã‚¸é–¢æ•°åŒ–ï¼ˆé«˜é€ŸåŒ–ï¼‰

**app/api/sessions/route.tsï¼ˆEdge Runtimeç‰ˆï¼‰**

```typescript
export const runtime = 'edge' // â† Edge Runtimeã§å®Ÿè¡Œ

import { NextRequest, NextResponse } from 'next/server'

export async function GET(request: NextRequest) {
  // Edge Networkã®æœ€å¯„ã‚Šã®ãƒãƒ¼ãƒ‰ã§å®Ÿè¡Œã•ã‚Œã‚‹
  // ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ãƒ¼ãŒå¤§å¹…ã«å‰Šæ¸›

  // ... (å®Ÿè£…)
}
```

**ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ãƒ¼æ¯”è¼ƒ**:
- Serverless Function: 50-200ms
- Edge Function: **10-50ms**ï¼ˆæœ€å¤§10å€é«˜é€Ÿï¼‰

---

### 6.3 ISRï¼ˆIncremental Static Regenerationï¼‰

**app/dashboard/page.tsx**

```typescript
export const revalidate = 60 // 60ç§’ã”ã¨ã«å†ç”Ÿæˆ

export default async function DashboardPage() {
  const sessions = await fetchSessions()

  return (
    <div>
      {/* ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸€è¦§ */}
    </div>
  )
}
```

**ãƒ¡ãƒªãƒƒãƒˆ**:
- åˆå›ã‚¢ã‚¯ã‚»ã‚¹: é™çš„HTMLï¼ˆè¶…é«˜é€Ÿï¼‰
- 60ç§’ã”ã¨ã«è‡ªå‹•æ›´æ–°
- ã‚µãƒ¼ãƒãƒ¼è² è·å‰Šæ¸›

---

## 7. å®Ÿè£…ã‚¿ã‚¹ã‚¯

### Phase 1: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç§»è¡Œï¼ˆ1-2æ—¥ï¼‰

| ã‚¿ã‚¹ã‚¯ | æ‰€è¦æ™‚é–“ | å„ªå…ˆåº¦ |
|--------|----------|--------|
| Next.js App Routerã¸ç§»è¡Œ | 4æ™‚é–“ | ğŸ”´ High |
| Flask API â†’ Next.js API Routesã¸å¤‰æ› | 6æ™‚é–“ | ğŸ”´ High |
| Supabaseã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¨­å®š | 2æ™‚é–“ | ğŸ”´ High |
| èªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢å®Ÿè£… | 2æ™‚é–“ | ğŸ”´ High |

**åˆè¨ˆ**: 14æ™‚é–“

---

### Phase 2: Vercelãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆåŠæ—¥ï¼‰

| ã‚¿ã‚¹ã‚¯ | æ‰€è¦æ™‚é–“ | å„ªå…ˆåº¦ |
|--------|----------|--------|
| Vercelãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ | 30åˆ† | ğŸ”´ High |
| ç’°å¢ƒå¤‰æ•°è¨­å®š | 30åˆ† | ğŸ”´ High |
| åˆå›ãƒ‡ãƒ—ãƒ­ã‚¤ | 30åˆ† | ğŸ”´ High |
| å‹•ä½œç¢ºèª | 2æ™‚é–“ | ğŸ”´ High |

**åˆè¨ˆ**: 4æ™‚é–“

---

### Phase 3: æœ€é©åŒ–ï¼ˆ1æ—¥ï¼‰

| ã‚¿ã‚¹ã‚¯ | æ‰€è¦æ™‚é–“ | å„ªå…ˆåº¦ |
|--------|----------|--------|
| Edge FunctionsåŒ– | 2æ™‚é–“ | ğŸŸ¡ Medium |
| ISRè¨­å®š | 2æ™‚é–“ | ğŸŸ¡ Medium |
| ç”»åƒæœ€é©åŒ– | 2æ™‚é–“ | ğŸŸ¡ Medium |
| ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ | 2æ™‚é–“ | ğŸŸ¡ Medium |

**åˆè¨ˆ**: 8æ™‚é–“

---

### ç·æ‰€è¦æ™‚é–“: 26æ™‚é–“ï¼ˆ3-4æ—¥ï¼‰

**AWS ECSæ¡ˆ**: 80æ™‚é–“ï¼ˆ10æ—¥ï¼‰
**Vercelæ¡ˆ**: 26æ™‚é–“ï¼ˆ3-4æ—¥ï¼‰

**å‰Šæ¸›æ™‚é–“**: 54æ™‚é–“ï¼ˆ**67%å‰Šæ¸›**ï¼‰

---

## 8. ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ•ãƒ­ãƒ¼

```mermaid
sequenceDiagram
    participant Dev as é–‹ç™ºè€…
    participant GitHub as GitHub
    participant Vercel as Vercel
    participant Edge as Edge Network
    participant User as ãƒ¦ãƒ¼ã‚¶ãƒ¼

    Note over Dev,User: ã‚³ãƒ¼ãƒ‰å¤‰æ›´ã¨ãƒ‡ãƒ—ãƒ­ã‚¤

    Dev->>GitHub: git push origin main
    GitHub->>Vercel: Webhooké€šçŸ¥
    Vercel->>Vercel: ãƒ“ãƒ«ãƒ‰é–‹å§‹
    Vercel->>Vercel: Next.js ãƒ“ãƒ«ãƒ‰
    Vercel->>Vercel: æœ€é©åŒ–
    Vercel->>Edge: ã‚°ãƒ­ãƒ¼ãƒãƒ«é…ä¿¡
    Vercel->>Dev: ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†é€šçŸ¥ï¼ˆSlack/Emailï¼‰

    Note over Dev,User: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚¯ã‚»ã‚¹

    User->>Edge: https://hera.vercel.app
    Edge->>Edge: æœ€å¯„ã‚Šã®ã‚¨ãƒƒã‚¸ã§å¿œç­”
    Edge->>User: è¶…é«˜é€Ÿãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆ10-50msï¼‰

    Note over Dev,User: ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ‡ãƒ—ãƒ­ã‚¤

    Dev->>GitHub: PRä½œæˆï¼ˆfeature/new-featureï¼‰
    GitHub->>Vercel: PRæ¤œå‡º
    Vercel->>Vercel: ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ“ãƒ«ãƒ‰
    Vercel->>GitHub: ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼URLæŠ•ç¨¿
    Note right of GitHub: https://hera-git-feature-new-feature.vercel.app
    Dev->>Dev: ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç¢ºèª
    Dev->>GitHub: PR ãƒãƒ¼ã‚¸
    GitHub->>Vercel: æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤
```

---

## 9. ã¾ã¨ã‚

### âœ… Vercelã‚’ä½¿ã†ãƒ¡ãƒªãƒƒãƒˆ

1. **ã‚³ã‚¹ãƒˆå‰Šæ¸›**: å¹´é–“$1,380-$1,620å‰Šæ¸›ï¼ˆ55-64%ï¼‰
2. **ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ç°¡ç´ åŒ–**: 8æ™‚é–“ â†’ 30åˆ†ï¼ˆ-94%ï¼‰
3. **ãƒ‡ãƒ—ãƒ­ã‚¤é«˜é€ŸåŒ–**: 3åˆ† â†’ 30ç§’ï¼ˆ-83%ï¼‰
4. **ã‚°ãƒ­ãƒ¼ãƒãƒ«CDN**: æ¨™æº–è£…å‚™
5. **è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°**: ç„¡é™ã‚¹ã‚±ãƒ¼ãƒ«
6. **ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ‡ãƒ—ãƒ­ã‚¤**: PRæ¯ã«è‡ªå‹•ç”Ÿæˆ
7. **ã‚¼ãƒ­ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ **: æ¨™æº–

### ğŸ“Š ã‚³ã‚¹ãƒˆæ¯”è¼ƒï¼ˆå¹´é–“ï¼‰

| æ§‹æˆ | å¹´é–“ã‚³ã‚¹ãƒˆ |
|------|-----------|
| **AWS ECS + Supabase** | $2,520 |
| **Vercel Pro + Supabase** | $1,140 |
| **å‰Šæ¸›é¡** | **$1,380ï¼ˆ55%ï¼‰** |

### ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. **Phase 1**: Next.js API Routesã¸ç§»è¡Œï¼ˆ2æ—¥ï¼‰
2. **Phase 2**: Vercelãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆåŠæ—¥ï¼‰
3. **Phase 3**: æœ€é©åŒ–ï¼ˆ1æ—¥ï¼‰

**åˆè¨ˆ**: 3-4æ—¥ã§æœ¬ç•ªç¨¼åƒï¼

---

**Vercelã§ã€æœ€é€Ÿãƒ»æœ€å®‰ãƒ»æœ€é«˜ã®Heraã‚’å®Ÿç¾ã—ã¾ã—ã‚‡ã†ï¼**
